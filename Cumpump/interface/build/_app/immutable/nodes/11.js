import{s as we,e as fe,n as O,h as pe,r as Me,b as We}from"../chunks/utils.js";import{q as Ie,H as Oe,r as Pe,g as k,u as He,d as u,v as ge,i as D,e as ve,o as dt,n as lt,b as h,k as $e,s as U,f as _,l as Ue,c as B,B as se,h as f,w as c,C as Ge,y as ie,I as mt,m as at,D as it,x as ot,L as Re,A as ht}from"../chunks/scheduler.js";import{h as _t,u as pt}from"../chunks/await_block.js";import{e as Ye}from"../chunks/each.js";import{S as ke,i as ye,a as A,g as Ae,t as N,c as je,o as ut,b as X,d as Q,m as Z,p as Be,e as ee}from"../chunks/index.js";import{g as gt}from"../chunks/navigation.js";import{X as ct,a as Se,o as Ne,d as vt,C as bt}from"../chunks/ConfirmDialog.js";import{g as Ve,f as Fe,u as Ke,c as Xe,s as Qe}from"../chunks/index2.js";import{p as wt}from"../chunks/stores.js";import{n as Ze}from"../chunks/notifications.js";import{I as ft}from"../chunks/InputPassword.js";import{S as kt}from"../chunks/SettingsCard.js";import{S as yt}from"../chunks/Spinner.js";import{P as xt,T as Et}from"../chunks/pencil.js";import{U as Tt}from"../chunks/users.js";import{A as Ct}from"../chunks/alert-triangle.js";const St=async()=>({title:"Users"}),dn=Object.freeze(Object.defineProperty({__proto__:null,load:St},Symbol.toStringTag,{value:"Module"}));function $t(l){let e,n,t='<g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M6 4h10l4 4v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2"/><path d="M10 14a2 2 0 1 0 4 0a2 2 0 1 0-4 0m4-10v4H8V4"/></g>',s=[{viewBox:"0 0 24 24"},{width:"1.2em"},{height:"1.2em"},l[0]],i={};for(let r=0;r<s.length;r+=1)i=fe(i,s[r]);return{c(){e=Ie("svg"),n=new Oe(!0),this.h()},l(r){e=Pe(r,"svg",{viewBox:!0,width:!0,height:!0});var d=k(e);n=He(d,!0),d.forEach(u),this.h()},h(){n.a=null,ge(e,i)},m(r,d){D(r,e,d),n.m(t,e)},p(r,[d]){ge(e,i=Ve(s,[{viewBox:"0 0 24 24"},{width:"1.2em"},{height:"1.2em"},d&1&&r[0]]))},i:O,o:O,d(r){r&&u(e)}}}function Ut(l,e,n){return l.$$set=t=>{n(0,e=fe(fe({},e),pe(t)))},e=pe(e),[e]}class Bt extends ke{constructor(e){super(),ye(this,e,Ut,$t,we,{})}}function et(l){let e,n,t,s,i,r,d,o,v,C='<span class="label-text text-md">Username</span>',$,y,j,M,p,P,m,x,b,G,te='<span class="label-text text-md">Password</span>',I,E,H,oe,V,L,le,J,ae="Is Admin?",Y,de,ue,F,K,W,w,xe="Cancel",be,ne,a,g,R="Save",T,z,he,me;function Ee(S){l[10](S)}let _e={id:"pwd"};return l[0].password!==void 0&&(_e.value=l[0].password),E=new ft({props:_e}),lt.push(()=>ut(E,"value",Ee)),W=new ct({props:{class:"mr-2 h-5 w-5"}}),a=new Bt({props:{class:"mr-2 h-5 w-5"}}),{c(){e=h("div"),n=h("div"),t=h("h2"),s=$e(l[2]),i=U(),r=h("div"),d=U(),o=h("form"),v=h("label"),v.innerHTML=C,$=U(),y=h("input"),M=U(),p=h("label"),P=h("span"),m=$e("Username must be between 3 and 32 characters long"),b=U(),G=h("label"),G.innerHTML=te,I=U(),X(E.$$.fragment),oe=U(),V=h("label"),L=h("input"),le=U(),J=h("span"),J.textContent=ae,Y=U(),de=h("div"),ue=U(),F=h("div"),K=h("button"),X(W.$$.fragment),w=h("span"),w.textContent=xe,be=U(),ne=h("button"),X(a.$$.fragment),g=h("span"),g.textContent=R,this.h()},l(S){e=_(S,"DIV",{role:!0,class:!0});var re=k(e);n=_(re,"DIV",{class:!0});var ce=k(n);t=_(ce,"H2",{class:!0});var ze=k(t);s=Ue(ze,l[2]),ze.forEach(u),i=B(ce),r=_(ce,"DIV",{class:!0}),k(r).forEach(u),d=B(ce),o=_(ce,"FORM",{class:!0});var q=k(o);v=_(q,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),se(v)!=="svelte-yk7p3p"&&(v.innerHTML=C),$=B(q),y=_(q,"INPUT",{type:!0,min:!0,max:!0,class:!0,id:!0}),M=B(q),p=_(q,"LABEL",{for:!0,class:!0});var qe=k(p);P=_(qe,"SPAN",{class:!0});var Je=k(P);m=Ue(Je,"Username must be between 3 and 32 characters long"),Je.forEach(u),qe.forEach(u),b=B(q),G=_(q,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),se(G)!=="svelte-1ur0rr9"&&(G.innerHTML=te),I=B(q),Q(E.$$.fragment,q),oe=B(q),V=_(q,"LABEL",{class:!0});var Te=k(V);L=_(Te,"INPUT",{type:!0,class:!0}),le=B(Te),J=_(Te,"SPAN",{class:!0,"data-svelte-h":!0}),se(J)!=="svelte-l7bjep"&&(J.textContent=ae),Te.forEach(u),Y=B(q),de=_(q,"DIV",{class:!0}),k(de).forEach(u),ue=B(q),F=_(q,"DIV",{class:!0});var Ce=k(F);K=_(Ce,"BUTTON",{class:!0,type:!0});var Le=k(K);Q(W.$$.fragment,Le),w=_(Le,"SPAN",{"data-svelte-h":!0}),se(w)!=="svelte-2921c8"&&(w.textContent=xe),Le.forEach(u),be=B(Ce),ne=_(Ce,"BUTTON",{class:!0,type:!0});var De=k(ne);Q(a.$$.fragment,De),g=_(De,"SPAN",{"data-svelte-h":!0}),se(g)!=="svelte-l126tb"&&(g.textContent=R),De.forEach(u),Ce.forEach(u),q.forEach(u),ce.forEach(u),re.forEach(u),this.h()},h(){f(t,"class","text-base-content text-start text-2xl font-bold"),f(r,"class","divider my-2"),f(v,"class","label"),f(v,"for","username"),f(y,"type","text"),f(y,"min","3"),f(y,"max","32"),f(y,"class","input input-bordered invalid:border-error w-full invalid:border-2"),f(y,"id","username"),y.disabled=j=!l[4],f(P,"class",x="label-text-alt text-error "+(l[3]?"":"hidden")),f(p,"for","username"),f(p,"class","label"),f(G,"class","label"),f(G,"for","pwd"),f(L,"type","checkbox"),f(L,"class","checkbox checkbox-primary"),f(J,"class",""),f(V,"class","label my-auto cursor-pointer justify-start gap-4"),f(de,"class","divider my-2"),f(K,"class","btn btn-neutral text-neutral-content inline-flex items-center"),f(K,"type","button"),f(ne,"class","btn btn-primary text-primary-content inline-flex items-center"),f(ne,"type","submit"),f(F,"class","flex justify-end gap-2"),f(o,"class","form-control text-base-content mb-1 w-full"),o.noValidate=!0,f(n,"class","rounded-box bg-base-100 shadow-secondary/30 pointer-events-auto flex min-w-fit max-w-md flex-col justify-between p-4 shadow-lg md:w-[28rem]"),f(e,"role","dialog"),f(e,"class","pointer-events-none fixed inset-0 z-50 flex items-center justify-center overflow-y-auto")},m(S,re){D(S,e,re),c(e,n),c(n,t),c(t,s),c(n,i),c(n,r),c(n,d),c(n,o),c(o,v),c(o,$),c(o,y),Ge(y,l[0].username),c(o,M),c(o,p),c(p,P),c(P,m),c(o,b),c(o,G),c(o,I),Z(E,o,null),c(o,oe),c(o,V),c(V,L),L.checked=l[0].admin,c(V,le),c(V,J),c(o,Y),c(o,de),c(o,ue),c(o,F),c(F,K),Z(W,K,null),c(K,w),c(F,be),c(F,ne),Z(a,ne,null),c(ne,g),z=!0,he||(me=[ie(y,"input",l[9]),ie(L,"change",l[11]),ie(K,"click",Se),ie(o,"submit",mt(l[5])),ie(e,"introstart",l[7]),ie(e,"outroend",l[8])],he=!0)},p(S,re){(!z||re&4)&&at(s,S[2]),(!z||re&16&&j!==(j=!S[4]))&&(y.disabled=j),re&1&&y.value!==S[0].username&&Ge(y,S[0].username),(!z||re&8&&x!==(x="label-text-alt text-error "+(S[3]?"":"hidden")))&&f(P,"class",x);const ce={};!H&&re&1&&(H=!0,ce.value=S[0].password,it(()=>H=!1)),E.$set(ce),re&1&&(L.checked=S[0].admin)},i(S){z||(A(E.$$.fragment,S),A(W.$$.fragment,S),A(a.$$.fragment,S),S&&ot(()=>{z&&(T||(T=Be(e,Fe,{y:50},!0)),T.run(1))}),z=!0)},o(S){N(E.$$.fragment,S),N(W.$$.fragment,S),N(a.$$.fragment,S),S&&(T||(T=Be(e,Fe,{y:50},!1)),T.run(0)),z=!1},d(S){S&&u(e),ee(E),ee(W),ee(a),S&&T&&T.end(),he=!1,Me(me)}}}function At(l){let e,n,t=l[1]&&et(l);return{c(){t&&t.c(),e=ve()},l(s){t&&t.l(s),e=ve()},m(s,i){t&&t.m(s,i),D(s,e,i),n=!0},p(s,[i]){s[1]?t?(t.p(s,i),i&2&&A(t,1)):(t=et(s),t.c(),A(t,1),t.m(e.parentNode,e)):t&&(Ae(),N(t,1,1,()=>{t=null}),je())},i(s){n||(A(t),n=!0)},o(s){N(t),n=!1},d(s){s&&u(e),t&&t.d(s)}}}function jt(l,e,n){let{isOpen:t}=e,{title:s}=e,{onSaveUser:i}=e,{user:r={username:"",password:"",admin:!1}}=e,d=!1,o=!1;dt(()=>{r.username==""&&n(4,o=!0)});function v(){r.username.length<3||r.username.length>32?n(3,d=!0):(n(3,d=!1),i(r))}function C(p){Re.call(this,l,p)}function $(p){Re.call(this,l,p)}function y(){r.username=this.value,n(0,r)}function j(p){l.$$.not_equal(r.password,p)&&(r.password=p,n(0,r))}function M(){r.admin=this.checked,n(0,r)}return l.$$set=p=>{"isOpen"in p&&n(1,t=p.isOpen),"title"in p&&n(2,s=p.title),"onSaveUser"in p&&n(6,i=p.onSaveUser),"user"in p&&n(0,r=p.user)},[r,t,s,d,o,v,i,C,$,y,j,M]}class tt extends ke{constructor(e){super(),ye(this,e,jt,At,we,{isOpen:1,title:2,onSaveUser:6,user:0})}}function Lt(l){let e,n,t='<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7a4 4 0 1 0 8 0a4 4 0 0 0-8 0m8 12h6m-3-3v6M6 21v-2a4 4 0 0 1 4-4h4"/>',s=[{viewBox:"0 0 24 24"},{width:"1.2em"},{height:"1.2em"},l[0]],i={};for(let r=0;r<s.length;r+=1)i=fe(i,s[r]);return{c(){e=Ie("svg"),n=new Oe(!0),this.h()},l(r){e=Pe(r,"svg",{viewBox:!0,width:!0,height:!0});var d=k(e);n=He(d,!0),d.forEach(u),this.h()},h(){n.a=null,ge(e,i)},m(r,d){D(r,e,d),n.m(t,e)},p(r,[d]){ge(e,i=Ve(s,[{viewBox:"0 0 24 24"},{width:"1.2em"},{height:"1.2em"},d&1&&r[0]]))},i:O,o:O,d(r){r&&u(e)}}}function Dt(l,e,n){return l.$$set=t=>{n(0,e=fe(fe({},e),pe(t)))},e=pe(e),[e]}class Nt extends ke{constructor(e){super(),ye(this,e,Dt,Lt,we,{})}}function Mt(l){let e,n,t='<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m16.555 3.843l3.602 3.602a2.877 2.877 0 0 1 0 4.069l-2.643 2.643a2.877 2.877 0 0 1-4.069 0l-.301-.301l-6.558 6.558a2 2 0 0 1-1.239.578L5.172 21H4a1 1 0 0 1-.993-.883L3 20v-1.172a2 2 0 0 1 .467-1.284l.119-.13L4 17h2v-2h2v-2l2.144-2.144l-.301-.301a2.877 2.877 0 0 1 0-4.069l2.643-2.643a2.877 2.877 0 0 1 4.069 0zM15 9h.01"/>',s=[{viewBox:"0 0 24 24"},{width:"1.2em"},{height:"1.2em"},l[0]],i={};for(let r=0;r<s.length;r+=1)i=fe(i,s[r]);return{c(){e=Ie("svg"),n=new Oe(!0),this.h()},l(r){e=Pe(r,"svg",{viewBox:!0,width:!0,height:!0});var d=k(e);n=He(d,!0),d.forEach(u),this.h()},h(){n.a=null,ge(e,i)},m(r,d){D(r,e,d),n.m(t,e)},p(r,[d]){ge(e,i=Ve(s,[{viewBox:"0 0 24 24"},{width:"1.2em"},{height:"1.2em"},d&1&&r[0]]))},i:O,o:O,d(r){r&&u(e)}}}function It(l,e,n){return l.$$set=t=>{n(0,e=fe(fe({},e),pe(t)))},e=pe(e),[e]}class Ot extends ke{constructor(e){super(),ye(this,e,It,Mt,we,{})}}function nt(l,e,n){const t=l.slice();return t[15]=e[n],t[17]=n,t}function Pt(l){let e=gt("/")+"",n;return{c(){n=$e(e)},l(t){n=Ue(t,e)},m(t,s){D(t,n,s)},p:O,i:O,o:O,d(t){t&&u(n)}}}function Ht(l){let e,n,t;return n=new kt({props:{collapsible:!1,$$slots:{title:[Gt],icon:[Wt],default:[Jt]},$$scope:{ctx:l}}}),{c(){e=h("div"),X(n.$$.fragment),this.h()},l(s){e=_(s,"DIV",{class:!0});var i=k(e);Q(n.$$.fragment,i),i.forEach(u),this.h()},h(){f(e,"class","mx-0 my-1 flex flex-col space-y-4 sm:mx-8 sm:my-8")},m(s,i){D(s,e,i),Z(n,e,null),t=!0},p(s,i){const r={};i&262145&&(r.$$scope={dirty:i,ctx:s}),n.$set(r)},i(s){t||(A(n.$$.fragment,s),t=!0)},o(s){N(n.$$.fragment,s),t=!1},d(s){s&&u(e),ee(n)}}}function Vt(l){return{c:O,l:O,m:O,p:O,i:O,o:O,d:O}}function zt(l){let e,n,t,s,i,r,d,o='<tr class="font-bold"><th align="left">Username</th> <th align="center">Admin</th> <th align="right" class="pr-8">Edit</th></tr>',v,C,$,y,j,M,p,P="Security Settings",m,x,b,G,te,I=`The JWT secret is used to sign authentication tokens. If you modify the JWT Secret, all\r
						users will be signed out.`,E,H,oe='<span class="label-text text-md">JWT Secret</span>',V,L,le,J,ae,Y,de="Apply Settings",ue,F,K;t=new Nt({props:{class:"h-6 w-6"}});let W=Ye(l[0].users),w=[];for(let a=0;a<W.length;a+=1)w[a]=st(nt(l,W,a));const xe=a=>N(w[a],1,1,()=>{w[a]=null});b=new Ct({props:{class:"h-6 w-6 flex-shrink-0"}});function be(a){l[10](a)}let ne={id:"secret"};return l[0].jwt_secret!==void 0&&(ne.value=l[0].jwt_secret),L=new ft({props:ne}),lt.push(()=>ut(L,"value",be)),{c(){e=h("div"),n=h("button"),X(t.$$.fragment),s=U(),i=h("div"),r=h("table"),d=h("thead"),d.innerHTML=o,v=U(),C=h("tbody");for(let a=0;a<w.length;a+=1)w[a].c();y=U(),j=h("div"),M=U(),p=h("span"),p.textContent=P,m=U(),x=h("div"),X(b.$$.fragment),G=U(),te=h("span"),te.textContent=I,E=U(),H=h("label"),H.innerHTML=oe,V=U(),X(L.$$.fragment),J=U(),ae=h("div"),Y=h("button"),Y.textContent=de,this.h()},l(a){e=_(a,"DIV",{class:!0});var g=k(e);n=_(g,"BUTTON",{class:!0});var R=k(n);Q(t.$$.fragment,R),R.forEach(u),s=B(g),i=_(g,"DIV",{class:!0});var T=k(i);r=_(T,"TABLE",{class:!0});var z=k(r);d=_(z,"THEAD",{"data-svelte-h":!0}),se(d)!=="svelte-176ku3j"&&(d.innerHTML=o),v=B(z),C=_(z,"TBODY",{});var he=k(C);for(let _e=0;_e<w.length;_e+=1)w[_e].l(he);he.forEach(u),z.forEach(u),T.forEach(u),g.forEach(u),y=B(a),j=_(a,"DIV",{class:!0}),k(j).forEach(u),M=B(a),p=_(a,"SPAN",{class:!0,"data-svelte-h":!0}),se(p)!=="svelte-1arxk0i"&&(p.textContent=P),m=B(a),x=_(a,"DIV",{class:!0});var me=k(x);Q(b.$$.fragment,me),G=B(me),te=_(me,"SPAN",{"data-svelte-h":!0}),se(te)!=="svelte-18xrzs"&&(te.textContent=I),me.forEach(u),E=B(a),H=_(a,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),se(H)!=="svelte-ohw44g"&&(H.innerHTML=oe),V=B(a),Q(L.$$.fragment,a),J=B(a),ae=_(a,"DIV",{class:!0});var Ee=k(ae);Y=_(Ee,"BUTTON",{class:!0,"data-svelte-h":!0}),se(Y)!=="svelte-agutg9"&&(Y.textContent=de),Ee.forEach(u),this.h()},h(){f(n,"class","btn btn-primary text-primary-content btn-md absolute -top-14 right-0"),f(r,"class","table w-full table-auto"),f(i,"class","overflow-x-auto"),f(e,"class","relative w-full overflow-visible"),f(j,"class","divider mb-0"),f(p,"class","pb-2 text-xl font-medium"),f(x,"class","alert alert-warning shadow-lg"),f(H,"class","label"),f(H,"for","secret"),f(Y,"class","btn btn-primary"),f(ae,"class","mt-6 flex justify-end")},m(a,g){D(a,e,g),c(e,n),Z(t,n,null),c(e,s),c(e,i),c(i,r),c(r,d),c(r,v),c(r,C);for(let R=0;R<w.length;R+=1)w[R]&&w[R].m(C,null);D(a,y,g),D(a,j,g),D(a,M,g),D(a,p,g),D(a,m,g),D(a,x,g),Z(b,x,null),c(x,G),c(x,te),D(a,E,g),D(a,H,g),D(a,V,g),Z(L,a,g),D(a,J,g),D(a,ae,g),c(ae,Y),ue=!0,F||(K=[ie(n,"click",l[6]),ie(Y,"click",l[11])],F=!0)},p(a,g){if(g&49){W=Ye(a[0].users);let T;for(T=0;T<W.length;T+=1){const z=nt(a,W,T);w[T]?(w[T].p(z,g),A(w[T],1)):(w[T]=st(z),w[T].c(),A(w[T],1),w[T].m(C,null))}for(Ae(),T=W.length;T<w.length;T+=1)xe(T);je()}const R={};!le&&g&1&&(le=!0,R.value=a[0].jwt_secret,it(()=>le=!1)),L.$set(R)},i(a){if(!ue){A(t.$$.fragment,a);for(let g=0;g<W.length;g+=1)A(w[g]);a&&ot(()=>{ue&&($||($=Be(i,Qe,{duration:300,easing:Xe},!0)),$.run(1))}),A(b.$$.fragment,a),A(L.$$.fragment,a),ue=!0}},o(a){N(t.$$.fragment,a),w=w.filter(Boolean);for(let g=0;g<w.length;g+=1)N(w[g]);a&&($||($=Be(i,Qe,{duration:300,easing:Xe},!1)),$.run(0)),N(b.$$.fragment,a),N(L.$$.fragment,a),ue=!1},d(a){a&&(u(e),u(y),u(j),u(M),u(p),u(m),u(x),u(E),u(H),u(V),u(J),u(ae)),ee(t),ht(w,a),a&&$&&$.end(),ee(b),ee(L,a),F=!1,Me(K)}}}function rt(l){let e,n;return e=new Ot({props:{class:"text-secondary"}}),{c(){X(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,s){Z(e,t,s),n=!0},i(t){n||(A(e.$$.fragment,t),n=!0)},o(t){N(e.$$.fragment,t),n=!1},d(t){ee(e,t)}}}function st(l){let e,n,t=l[15].username+"",s,i,r,d,o,v,C,$,y,j,M,p,P,m,x,b=l[15].admin&&rt();$=new xt({props:{class:"h-6 w-6"}});function G(){return l[8](l[17])}M=new Et({props:{class:"text-error h-6 w-6"}});function te(){return l[9](l[17])}return{c(){e=h("tr"),n=h("td"),s=$e(t),i=U(),r=h("td"),b&&b.c(),d=U(),o=h("td"),v=h("span"),C=h("button"),X($.$$.fragment),y=U(),j=h("button"),X(M.$$.fragment),p=U(),this.h()},l(I){e=_(I,"TR",{});var E=k(e);n=_(E,"TD",{align:!0});var H=k(n);s=Ue(H,t),H.forEach(u),i=B(E),r=_(E,"TD",{align:!0});var oe=k(r);b&&b.l(oe),oe.forEach(u),d=B(E),o=_(E,"TD",{align:!0});var V=k(o);v=_(V,"SPAN",{class:!0});var L=k(v);C=_(L,"BUTTON",{class:!0});var le=k(C);Q($.$$.fragment,le),le.forEach(u),y=B(L),j=_(L,"BUTTON",{class:!0});var J=k(j);Q(M.$$.fragment,J),J.forEach(u),L.forEach(u),V.forEach(u),p=B(E),E.forEach(u),this.h()},h(){f(n,"align","left"),f(r,"align","center"),f(C,"class","btn btn-ghost btn-circle btn-xs"),f(j,"class","btn btn-ghost btn-circle btn-xs"),f(v,"class","my-auto inline-flex flex-row space-x-2"),f(o,"align","right")},m(I,E){D(I,e,E),c(e,n),c(n,s),c(e,i),c(e,r),b&&b.m(r,null),c(e,d),c(e,o),c(o,v),c(v,C),Z($,C,null),c(v,y),c(v,j),Z(M,j,null),c(e,p),P=!0,m||(x=[ie(C,"click",G),ie(j,"click",te)],m=!0)},p(I,E){l=I,(!P||E&1)&&t!==(t=l[15].username+"")&&at(s,t),l[15].admin?b?E&1&&A(b,1):(b=rt(),b.c(),A(b,1),b.m(r,null)):b&&(Ae(),N(b,1,1,()=>{b=null}),je())},i(I){P||(A(b),A($.$$.fragment,I),A(M.$$.fragment,I),P=!0)},o(I){N(b),N($.$$.fragment,I),N(M.$$.fragment,I),P=!1},d(I){I&&u(e),b&&b.d(),ee($),ee(M),m=!1,Me(x)}}}function qt(l){let e,n;return e=new yt({}),{c(){X(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,s){Z(e,t,s),n=!0},p:O,i(t){n||(A(e.$$.fragment,t),n=!0)},o(t){N(e.$$.fragment,t),n=!1},d(t){ee(e,t)}}}function Jt(l){let e,n,t={ctx:l,current:null,token:null,hasCatch:!1,pending:qt,then:zt,catch:Vt,value:14,blocks:[,,,]};return _t(l[2](),t),{c(){e=ve(),t.block.c()},l(s){e=ve(),t.block.l(s)},m(s,i){D(s,e,i),t.block.m(s,t.anchor=i),t.mount=()=>e.parentNode,t.anchor=e,n=!0},p(s,i){l=s,pt(t,l,i)},i(s){n||(A(t.block),n=!0)},o(s){for(let i=0;i<3;i+=1){const r=t.blocks[i];N(r)}n=!1},d(s){s&&u(e),t.block.d(s),t.token=null,t=null}}}function Wt(l){let e,n;return e=new Tt({props:{slot:"icon",class:"lex-shrink-0 mr-2 h-6 w-6 self-end"}}),{c(){X(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,s){Z(e,t,s),n=!0},p:O,i(t){n||(A(e.$$.fragment,t),n=!0)},o(t){N(e.$$.fragment,t),n=!1},d(t){ee(e,t)}}}function Gt(l){let e,n="Manage Users";return{c(){e=h("span"),e.textContent=n,this.h()},l(t){e=_(t,"SPAN",{slot:!0,"data-svelte-h":!0}),se(e)!=="svelte-je9y8g"&&(e.textContent=n),this.h()},h(){f(e,"slot","title")},m(t,s){D(t,e,s)},p:O,d(t){t&&u(e)}}}function Rt(l){let e,n,t,s;const i=[Ht,Pt],r=[];function d(o,v){return o[1].admin?0:1}return e=d(l),n=r[e]=i[e](l),{c(){n.c(),t=ve()},l(o){n.l(o),t=ve()},m(o,v){r[e].m(o,v),D(o,t,v),s=!0},p(o,[v]){let C=e;e=d(o),e===C?r[e].p(o,v):(Ae(),N(r[C],1,1,()=>{r[C]=null}),je(),n=r[e],n?n.p(o,v):(n=r[e]=i[e](o),n.c()),A(n,1),n.m(t.parentNode,t))},i(o){s||(A(n),s=!0)},o(o){N(n),s=!1},d(o){o&&u(t),r[e].d(o)}}}function Yt(l,e,n){let t,s;We(l,Ke,m=>n(1,t=m)),We(l,wt,m=>n(12,s=m));let{data:i}=e,r;async function d(){try{const m=await fetch("/rest/securitySettings",{method:"GET",headers:{Authorization:s.data.features.security?"Bearer "+t.bearer_token:"Basic","Content-Type":"application/json"}});n(0,r=await m.json())}catch(m){console.error("Error:",m)}}async function o(m){try{const x=await fetch("/rest/securitySettings",{method:"POST",headers:{Authorization:s.data.features.security?"Bearer "+t.bearer_token:"Basic","Content-Type":"application/json"},body:JSON.stringify(m)});n(0,r=await x.json()),x.status==200?await v(t)&&Ze.success("Security settings updated.",3e3):Ze.error("User not authorized.",3e3)}catch(x){console.error("Error:",x)}}async function v(m){try{if((await fetch("/rest/verifyAuthorization",{method:"GET",headers:{Authorization:"Bearer "+m.bearer_token,"Content-Type":"application/json"}})).status!==200)return Ke.invalidate(),!1}catch(x){console.error("Error:",x)}return!0}function C(m){Ne(bt,{title:"Confirm Delete User",message:'Are you sure you want to delete the user "'+r.users[m].username+'"?',labels:{cancel:{label:"Abort",icon:ct},confirm:{label:"Yes",icon:vt}},onConfirm:()=>{r.users.splice(m,1),n(0,r),Se(),o(r)}})}function $(m){Ne(tt,{title:"Edit User",user:{...r.users[m]},onSaveUser:x=>{n(0,r.users[m]=x,r),Se(),o(r)}})}function y(){Ne(tt,{title:"Add User",onSaveUser:m=>{n(0,r.users=[...r.users,m],r),Se(),o(r)}})}const j=m=>$(m),M=m=>C(m);function p(m){l.$$.not_equal(r.jwt_secret,m)&&(r.jwt_secret=m,n(0,r))}const P=()=>o(r);return l.$$set=m=>{"data"in m&&n(7,i=m.data)},[r,t,d,o,C,$,y,i,j,M,p,P]}class mn extends ke{constructor(e){super(),ye(this,e,Yt,Rt,we,{data:7})}}export{mn as component,dn as universal};
